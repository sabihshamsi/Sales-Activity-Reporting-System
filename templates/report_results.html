<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSGC - Report Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .report-container {
            width: 100%;
            max-width: 1800px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .header-info {
            text-align: right;
            font-size: 12px;
            color: #666;
        }

        .report-title {
            color: #0054a6;
            text-align: center;
            margin-bottom: 20px;
        }

        .filters-summary {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .filters-summary h3 {
            color: #495057;
            margin-bottom: 10px;
        }

        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .filter-tag {
            background-color: #e9ecef;
            color: #495057;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            border: 1px solid #dee2e6;
        }

        .results-header {
            background-color: #0054a6;
            color: white;
            padding: 15px;
            border-radius: 5px 5px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
        }

        .results-header h3 {
            margin: 0;
        }

        .results-count {
            background-color: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 12px;
        }

        .results-table th,
        .results-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .results-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .results-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .results-table tr:hover {
            background-color: #e9ecef;
        }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }

        .btn-primary {
            background-color: #0054a6;
            color: white;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-info {
            background-color: #17a2b8;
            color: white;
        }

        .export-options {
            display: flex;
            gap: 10px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 18px;
        }

        .table-container {
            overflow-x: auto;
            border: 1px solid #dee2e6;
            border-radius: 0 0 5px 5px;
            max-height: 70vh;
            overflow-y: auto;
        }

        /* Search box styles */
        .search-container {
            display: flex;
            margin-bottom: 11px;
            margin-top: 15px;
            gap: 10px;
            justify-content: flex-end;
        }

        .search-box {
            flex: 1;
            max-width: 300px;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .search-btn {
            padding: 10px 20px;
            background-color: #0054a6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .search-btn:hover {
            background-color: #003d7a;
        }

        .table-search-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 5px;
        }

        .pagination-btn {
            padding: 8px 12px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            cursor: pointer;
        }

        .pagination-btn.active {
            background-color: #0054a6;
            color: white;
            border-color: #0054a6;
        }

        .column-toggle {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }

        .column-toggle label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .sticky-header {
            position: sticky;
            top: 0;
            background-color: #f8f9fa;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .page-size-selector {
            margin-bottom: 15px;
        }

        .page-size-selector select {
            width: auto;
            display: inline-block;
        }

        .pagination-info {
            font-weight: bold;
            color: #6c757d;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <div class="report-container">
        <div class="header">
            <div class="logo">
                <h1>SSGC</h1>
                <p class="subtitle">SUI SOUTHERN GAS COMPANY LIMITED</p>
            </div>
            <div class="header-info">
                <p>Report Results</p>
                <p>Generated: {{ current_time }}</p>
            </div>
        </div>

        <h2 class="report-title">FIELD ACTIVITY DETAILED REPORT RESULTS</h2>

        <!-- Action Buttons at the Top -->
        <div class="action-buttons">
            <div>
                <!-- In the action-buttons div, add this button -->
<a href="{{ url_for('summary_report') }}" class="btn btn-info">View Summary</a>
                <a href="/gen_report" class="btn btn-secondary">‚Üê Back to Report Generator</a>
            </div>
            <div class="export-options">
                <button class="btn btn-info" onclick="window.print()">Print Report</button>
                <button class="btn btn-success" onclick="exportToCSV()">Export to CSV</button>
                <a href="/logout" class="btn btn-primary">Logout</a>
            </div>
        </div>

        <!-- Filters Summary -->
        <div class="filters-summary">
            <h3>Applied Filters</h3>
            <div class="filter-tags">
                {% if filters.billing_month %}
                <span class="filter-tag">Billing Month: {{ filters.billing_month }}</span>
                {% endif %}
                {% if filters.cust_cl_cd %}
                <span class="filter-tag">Customer Class: {{ filters.cust_cl_cd }}</span>
                {% endif %}
                {% if filters.account_id %}
                <span class="filter-tag">Account ID: {{ filters.account_id }}</span>
                {% endif %}
                {% if filters.unit %}
                <span class="filter-tag">Unit: {{ filters.unit }}</span>
                {% endif %}
                {% if filters.region %}
                <span class="filter-tag">Region: {{ filters.region }}</span>
                {% endif %}
                {% if filters.zone %}
                <span class="filter-tag">Zone: {{ filters.zone }}</span>
                {% endif %}
                {% if filters.subzone %}
                <span class="filter-tag">Sub Zone: {{ filters.subzone }}</span>
                {% endif %}
                {% if filters.area %}
                <span class="filter-tag">Area: {{ filters.area }}</span>
                {% endif %}
                {% if filters.activity_type %}
                <span class="filter-tag">Activity Type: {{ filters.activity_type }}</span>
                {% endif %}
                {% if filters.fa_status %}
                <span class="filter-tag">FA Status: {{ filters.fa_status }}</span>
                {% endif %}
                {% if filters.date_from %}
                <span class="filter-tag">From: {{ filters.date_from }}</span>
                {% endif %}
                {% if filters.date_to %}
                <span class="filter-tag">To: {{ filters.date_to }}</span>
                {% endif %}
                {% if not filters.billing_month and not filters.cust_cl_cd and not filters.account_id and not
                filters.unit and not filters.region and not filters.zone and not filters.subzone and not filters.area
                and not filters.activity_type and not filters.fa_status and not filters.date_from and not
                filters.date_to %}
                <span class="filter-tag">No filters applied (showing all records)</span>
                {% endif %}
            </div>
        </div>

        <!-- Page Size Selector and Pagination Info -->
        <div class="row align-items-center mb-3">
            <div class="col-md-6">
                <div class="page-size-selector">
                    <form method="get" class="form-inline">
                        <input type="hidden" name="page" value="1">
                        <label for="per_page" class="mr-2">Records per page:</label>
                        <select name="per_page" id="per_page" class="form-control form-control-sm"
                            onchange="this.form.submit()">
                            <option value="10" {% if per_page==10 %}selected{% endif %}>10</option>
                            <option value="25" {% if per_page==25 %}selected{% endif %}>25</option>
                            <option value="50" {% if per_page==50 %}selected{% endif %}>50</option>
                            <option value="100" {% if per_page==100 %}selected{% endif %}>100</option>
                            <option value="250" {% if per_page==250 %}selected{% endif %}>250</option>
                            <option value="500" {% if per_page==500 %}selected{% endif %}>500</option>
                        </select>
                    </form>
                </div>
            </div>
            <div class="col-md-6 text-md-right">
                <div class="pagination-info">
                    Showing {{ (page - 1) * per_page + 1 }} to {{ [page * per_page, total_records]|min }} of {{
                    total_records }} records
                </div>
            </div>
        </div>

        <!-- Results Header with Search -->
        <div class="results-header">
            <h3>Report Results</h3>
            <span class="results-count">{{ total_records }} records found</span>
        </div>

        <!-- Column Toggle Options -->
        <div class="column-toggle">
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="0" checked> Account ID</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="1" checked> Unit</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="2" checked> Region</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="3" checked> Zone</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="4" checked> Sub Zone</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="5" checked> Area</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="6" checked> Activity Type</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="7" checked> Status</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="8" checked> Date</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="9" checked> Description</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="10" checked> Billing Month</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="11" checked> Customer
                Class</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="12" checked> Gas Charges</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="13" checked> Total Bill</label>
            <label><input type="checkbox" class="column-toggle-checkbox" data-column="14" checked> Last Payment</label>
        </div>

        <!-- Search Box -->
        <div class="table-search-header">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-box" placeholder="Search across all columns...">
                <button class="search-btn" onclick="searchTable()">Search</button>
                <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
            </div>
        </div>

        <!-- Results Table -->
        <div class="table-container">
            {% if results %}
            <table class="results-table" id="resultsTable">
                <thead class="sticky-header">
                    <tr>
                        <th>Account ID</th>
                        <th>Unit</th>
                        <th>Region</th>
                        <th>Zone</th>
                        <th>Sub Zone</th>
                        <th>Area</th>
                        <th>Activity Type</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Description</th>
                        <th>Billing Month</th>
                        <th>Customer Class</th>
                        <th>Gas Charges</th>
                        <th>Meter Rent</th>
                        <th>GST</th>
                        <th>Total SCM</th>
                        <th>Total MMBTU</th>
                        <th>Less Prov Bills</th>
                        <th>Arrears</th>
                        <th>Total Current Bill</th>
                        <th>Total Net Bill</th>
                        <th>LPS Charged</th>
                        <th>LPS</th>
                        <th>Debit Dr</th>
                        <th>Credit Cr</th>
                        <th>Last Payment</th>
                        <th>Misc Adj</th>
                        <th>Others Adj</th>
                        <th>Other Amt</th>
                        <th>Other CM</th>
                        <th>Other MMBTU</th>
                        <th>Opening Balance</th>
                        <th>Closing Balance</th>
                        <th>Woglamt CM</th>
                        <th>Woglamt MMBTU</th>
                        <th>NP Fixed Charges</th>
                        <th>P Fixed Charges</th>
                        <th>Levy Charges</th>
                        <th>Levy Adj</th>
                        <th>NP Fix Adj</th>
                        <th>P Fix Adj</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in results %}
                    <tr>
                        <td>{{ item.Account_ID or '' }}</td>
                        <td>{{ item.Unit_Descr or '' }}</td>
                        <td>{{ item.Region_Descr or '' }}</td>
                        <td>{{ item.Zone_Descr or '' }}</td>
                        <td>{{ item.SubZone_Descr or '' }}</td>
                        <td>{{ item.Area_Descr or '' }}</td>
                        <td>{{ item.Activity_Type or '' }}</td>
                        <td>{{ item.FA_Status or '' }}</td>
                        <td>{{ item.Activity_Date or '' }}</td>
                        <td>{{ item.Description or '' }}</td>
                        <td>{{ item.Billing_Month or '' }}</td>
                        <td>{{ item.Cust_Cl_Cd or '' }}</td>
                        <td>{{ item.Gas_Charges or '' }}</td>
                        <td>{{ item.Meter_Rent or '' }}</td>
                        <td>{{ item.GST or '' }}</td>
                        <td>{{ item.Total_SCM or '' }}</td>
                        <td>{{ item.Total_MMBTU or '' }}</td>
                        <td>{{ item.Less_Prov_Bills or '' }}</td>
                        <td>{{ item.Arrears or '' }}</td>
                        <td>{{ item.Total_Cur_Bill or '' }}</td>
                        <td>{{ item.Total_Net_Bill or '' }}</td>
                        <td>{{ item.LPS_Charged or '' }}</td>
                        <td>{{ item.LPS or '' }}</td>
                        <td>{{ item.Debit_Dr or '' }}</td>
                        <td>{{ item.Credit_Cr or '' }}</td>
                        <td>{{ item.Last_Payment or '' }}</td>
                        <td>{{ item.Misc_Adj or '' }}</td>
                        <td>{{ item.Others_Adj or '' }}</td>
                        <td>{{ item.Other_Amt or '' }}</td>
                        <td>{{ item.Other_CM or '' }}</td>
                        <td>{{ item.Other_MMBTU or '' }}</td>
                        <td>{{ item.Op_Bal or '' }}</td>
                        <td>{{ item.Cl_Bal or '' }}</td>
                        <td>{{ item.WoglamtCM or '' }}</td>
                        <td>{{ item.WoglamtMMBTU or '' }}</td>
                        <td>{{ item.NP_Fixed_Charges or '' }}</td>
                        <td>{{ item.P_Fixed_Charges or '' }}</td>
                        <td>{{ item.Levy_Charges or '' }}</td>
                        <td>{{ item.Levy_Adj or '' }}</td>
                        <td>{{ item.NP_Fix_Adj or '' }}</td>
                        <td>{{ item.P_Fix_Adj or '' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="no-results">
                <h3>No Results Found</h3>
                <p>No records match the selected criteria.</p>
            </div>
            {% endif %}
        </div>

        <!-- Pagination Controls -->
        <div class="pagination-container mt-4">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    <!-- Previous Page -->
                    <li class="page-item {% if page <= 1 %}disabled{% endif %}">
                        <a class="page-link" href="{{ url_for('report_results', page=page-1, per_page=per_page) }}"
                            aria-label="Previous">
                            <span aria-hidden="true">&laquo; Previous</span>
                        </a>
                    </li>

                    <!-- Page Numbers -->
                    {% for p in range(1, total_pages + 1) %}
                    {% if p >= page - 2 and p <= page + 2 or p==1 or p==total_pages %} <li
                        class="page-item {% if p == page %}active{% endif %}">
                        <a class="page-link" href="{{ url_for('report_results', page=p, per_page=per_page) }}">{{ p
                            }}</a>
                        </li>
                        {% elif (p == page - 3 and page > 4) or (p == page + 3 and page < total_pages - 3) %} <li
                            class="page-item disabled">
                            <span class="page-link">...</span>
                            </li>
                            {% endif %}
                            {% endfor %}

                            <!-- Next Page -->
                            <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
                                <a class="page-link"
                                    href="{{ url_for('report_results', page=page+1, per_page=per_page) }}"
                                    aria-label="Next">
                                    <span aria-hidden="true">Next &raquo;</span>
                                </a>
                            </li>
                </ul>
            </nav>

            <!-- Quick Jump -->
            {% if total_pages > 1 %}
            <div class="page-jump mt-3">
                <form method="get" action="{{ url_for('report_results') }}" class="form-inline justify-content-center">
                    <input type="hidden" name="per_page" value="{{ per_page }}">
                    <div class="input-group input-group-sm" style="max-width: 200px;">
                        <input type="number" name="page" class="form-control" placeholder="Page" min="1"
                            max="{{ total_pages }}" required>
                        <div class="input-group-append">
                            <button type="submit" class="btn btn-primary">Go</button>
                        </div>
                    </div>
                </form>
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        // Set current time for the report
        document.addEventListener('DOMContentLoaded', function () {
            const now = new Date();
            document.querySelector('.header-info p:last-child').textContent = 'Generated: ' + now.toLocaleString();

            // Initialize column toggles
            initColumnToggles();

            // Store page size preference in sessionStorage
            const perPageSelect = document.getElementById('per_page');
            if (perPageSelect) {
                // Load saved preference
                const savedPerPage = sessionStorage.getItem('per_page');
                if (savedPerPage) {
                    perPageSelect.value = savedPerPage;
                }

                // Save preference on change
                perPageSelect.addEventListener('change', function () {
                    sessionStorage.setItem('per_page', this.value);
                });
            }
        });

        function exportToCSV() {
            // Get visible data only (considering hidden columns)
            const visibleColumns = [];
            document.querySelectorAll('.column-toggle-checkbox:checked').forEach(checkbox => {
                visibleColumns.push(parseInt(checkbox.dataset.column));
            });

            const table = document.getElementById('resultsTable');
            const rows = table.querySelectorAll('tr');
            if (rows.length <= 1) {
                alert('No data to export');
                return;
            }

            // Get headers from the first row (only visible columns)
            const headerCells = rows[0].querySelectorAll('th');
            let headers = [];
            visibleColumns.forEach(colIndex => {
                headers.push(headerCells[colIndex].textContent);
            });

            // Create CSV content
            let csvContent = headers.join(',') + '\n';

            // Add data rows (only visible columns)
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].querySelectorAll('td');
                const rowData = [];

                visibleColumns.forEach(colIndex => {
                    let value = cells[colIndex].textContent;
                    // Escape quotes and wrap in quotes if contains comma
                    value = '"' + value.replace(/"/g, '""') + '"';
                    rowData.push(value);
                });

                csvContent += rowData.join(',') + '\n';
            }

            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'ssgc_report.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Search functionality
        function searchTable() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toUpperCase();
            const table = document.getElementById('resultsTable');
            const tr = table.getElementsByTagName('tr');
            let visibleCount = 0;

            // Loop through all table rows (skip the header row)
            for (let i = 1; i < tr.length; i++) {
                let td = tr[i].getElementsByTagName('td');
                let found = false;

                // Loop through all table columns
                for (let j = 0; j < td.length; j++) {
                    if (td[j]) {
                        if (td[j].textContent.toUpperCase().indexOf(filter) > -1) {
                            found = true;
                            break;
                        }
                    }
                }

                if (found) {
                    tr[i].style.display = '';
                    visibleCount++;
                } else {
                    tr[i].style.display = 'none';
                }
            }

            // Update results count
            const resultsCount = document.querySelector('.results-count');
            if (resultsCount) {
                resultsCount.textContent = `${visibleCount} records found`;

                // Change color based on results
                if (visibleCount === 0) {
                    resultsCount.style.backgroundColor = '#dc3545'; // Red for no results
                } else {
                    resultsCount.style.backgroundColor = '#28a745'; // Green for results
                }
            }
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            searchTable(); // This will show all rows again

            // Restore original count
            const resultsCount = document.querySelector('.results-count');
            if (resultsCount) {
                resultsCount.textContent = '{{ total_records }} records found';
                resultsCount.style.backgroundColor = '#28a745';
            }
        }

        // Add event listener for Enter key in search box
        document.getElementById('searchInput').addEventListener('keyup', function (event) {
            if (event.key === 'Enter') {
                searchTable();
            }
        });

        // Column toggle functionality
        function initColumnToggles() {
            const checkboxes = document.querySelectorAll('.column-toggle-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function () {
                    const colIndex = parseInt(this.dataset.column);
                    const table = document.getElementById('resultsTable');
                    const headerCells = table.querySelectorAll('thead th');
                    const rows = table.querySelectorAll('tbody tr');

                    // Toggle visibility for header
                    headerCells[colIndex].style.display = this.checked ? '' : 'none';

                    // Toggle visibility for all data cells in this column
                    rows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        cells[colIndex].style.display = this.checked ? '' : 'none';
                    });
                });

                // Trigger change event to set initial state
                checkbox.dispatchEvent(new Event('change'));
            });
        }

        // Add print styles
        const style = document.createElement('style');
        style.textContent = `
            @media print {
                body { background: white; }
                .report-container { box-shadow: none; }
                .action-buttons, .filters-summary, .table-search-header, 
                .column-toggle, .pagination { display: none; }
                .results-header { background: #0054a6 !important; }
                .table-container { overflow: visible; max-height: none; }
            }
        `;
        document.head.appendChild(style);

        function generateSummaryReport() {
    // Get all current filter values from the page
    const filters = {
        billing_month: '{{ filters.billing_month }}',
        cust_cl_cd: '{{ filters.cust_cl_cd }}',
        account_id: '{{ filters.account_id }}',
        unit: '{{ filters.unit }}',
        region: '{{ filters.region }}',
        zone: '{{ filters.zone }}',
        subzone: '{{ filters.subzone }}',
        area: '{{ filters.area }}',
        activity_type: '{{ filters.activity_type }}',
        fa_status: '{{ filters.fa_status }}',
        date_from: '{{ filters.date_from }}',
        date_to: '{{ filters.date_to }}'
    };
    
    // Create a form to submit to the summary endpoint
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = '/generate_summary_report';
    
    // Add all filter values as hidden inputs
    Object.entries(filters).forEach(([name, value]) => {
        if (value && value !== 'None') {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = name;
            input.value = value;
            form.appendChild(input);
        }
    });
    
    // Submit the form
    document.body.appendChild(form);
    form.submit();
}
    </script>
</body>

</html>